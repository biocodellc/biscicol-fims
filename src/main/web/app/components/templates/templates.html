<h2 class="page-header">Generate Template</h2>

<div class="row" id="template-form">
    <form class="form-horizontal">

        <div class="form-group">
            <label class="control-label col-sm-3">Worksheet:</label>

            <div class="col-sm-4">
                <select class="form-control"
                        ng-disabled="vm.worksheets.length <= 1"
                        ng-model="vm.sheetName"
                        ng-options="sheet for sheet in vm.worksheets"
                        ng-change="vm.sheetChange()">
                </select>
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-sm-3">Template Config:</label>
            <div class="col-sm-4">
                <div class="input-group col-sm-12">
                    <select class="form-control"
                            ng-disabled="vm.templates.length <= 1"
                            ng-model="vm.template"
                            ng-options="t as t.name for t in vm.templates"
                            ng-change="vm.templateChange()">
                    </select>

                    <div class="input-group-btn" ng-show="vm.canRemoveTemplate()">
                        <button class="btn btn-danger"><i class="fa fa-trash fa-fw"></i></button>
                    </div>
                    <!--<div class="input-group-btn" ng-show="vm.isAuthenticated">-->
                    <!--<button class="btn btn-success"><i class="fa fa-check fa-fw"></i></button>-->
                    <!--</div>-->
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-6">
                <button type="button" ng-click="vm.generate()" class="btn btn-primary pull-right">Export Excel</button>
            </div>
        </div>
    </form>
</div>

<div class="row">

    <div class="col-xs-6">
        <uib-accordion close-others="false" ng-repeat="(group, attributes) in vm.attributes">
            <div uib-accordion-group class="panel-default" heading="{{ group }}" is-open="true">
                <div class="checkbox" ng-repeat="attribute in attributes">
                    <label>
                        <input type="checkbox"
                               ng-disabled="vm.required.indexOf(attribute) > -1"
                               ng-checked="vm.selected.indexOf(attribute) > -1"
                               ng-click="vm.toggleSelected(attribute)"/>
                        {{ attribute.column }}
                        <a href="#" ng-click="vm.defAttribute = attribute">DEF</a>
                    </label>
                </div>
            </div>
        </uib-accordion>
    </div>

    <div class="col-xs-6">
        <p>{{ vm.description }}</p>

        <div ng-include="'app/components/templates/attribute-definition.tpl.html'"
             ng-controller='AttributeDefController as defVm'></div>
    </div>

</div>
