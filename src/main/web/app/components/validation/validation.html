<div class="container">
    <div id="warning"></div>
    <div class="row">
        <h3 class="page-header">Validate and Load Data</h3>

        <div class="col-xs-12">
            <uib-tabset active="vm.activeTab">
                <uib-tab index="-1" heading="" disable="true" classes="col-xs-offset-1 hidden-tab"></uib-tab>

                <!-- Validation Tab -->
                <uib-tab index="0" heading="Validate">
                    <form role="form" name="validateForm" class="form-horizontal"
                          ng-submit="vm.fimsMetadata && vm.validate()">


                        <fims-data ng-model="vm.fimsMetadata"
                                   is-required="true"
                                   change="vm.fimsMetadataChange()"></fims-data>

                        <hr class="separator"/>

                        <div class="form-group" show-errors ng-show="vm.showProject">
                            <label class="col-sm-3 control-label">Project</label>
                            <div class="col-sm-8">
                                <project-select project="vm.project" select-classes="form-control"
                                                required="true"></project-select>
                            </div>
                        </div>

                        <div class="form-group" show-errors>
                            <label for="expeditionCode" class="col-xs-3 control-label">Expedition Name</label>
                            <div class="row col-xs-8">
                                <div class="col-xs-8" ng-show="!vm.newExpedition">
                                    <select id="expeditionCode" name="expeditionCode"
                                            ng-model="vm.expeditionCode"
                                            ng-change="vm.setIsPublic(expedition)"
                                            ng-options="expedition.expeditionCode as expedition.expeditionTitle for expedition in vm.expeditions | orderBy: 'expeditionTitle' track by expedition.expeditionId"
                                            required
                                            class="form-control col-xs-6">
                                        <option value="">-- Select an Expedition --</option>
                                    </select>
                                </div>
                                <div class="col-xs-8" ng-show="vm.newExpedition">
                                    <input type="text" class="form-control" name="newExpeditionCode"
                                           ng-model="vm.expeditionCode"
                                           required ng-pattern=/^[a-zA-Z0-9_-]{4,50}$/ />
                                </div>
                                <label class="col-xs-3 checkbox-inline">
                                    <input type="checkbox" name="newExpedition"
                                           ng-model="vm.newExpedition"
                                           ng-click="vm.expeditionCode = null"
                                           value="true"/>
                                    New Expedition?
                                </label>
                                <div class="col-xs-12" ng-show="vm.newExpedition">
                                    <p class="help-block"
                                       ng-if="vm.uploadForm.newExpeditionCode.$error.pattern && vm.uploadForm.newExpeditionCode.$touched">
                                        <b>Expedition
                                            Name</b> must contain only numbers, letters, or underscores and be 4 to 50
                                        characters long</p>
                                    <p class="help-block col-xs-12" style="padding-left:0px;"
                                       ng-show="vm.uploadForm.newExpeditionCode.$error.exists">
                                        Expedition with that name already exists
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-xs-1 col-xs-offset-9">
                                <button type="submit" class="btn btn-default pull-right">Validate</button>
                            </div>
                        </div>
                    </form>
                </uib-tab>

                <!-- Upload Tab -->
                <uib-tab index="1" heading="Upload" disable="!vm.isAuthenticated">

                    <form role="form" name="vm.uploadForm" class="form-horizontal" novalidate ng-submit="vm.upload()">

                        <fims-data ng-model="vm.fimsMetadata"
                                   is-required="true"
                                   change="vm.fimsMetadataChange()"></fims-data>

                        <hr class="separator"/>

                        <div class="form-group" show-errors ng-show="vm.showProject">
                            <label class="col-sm-3 control-label">Project</label>
                            <div class="col-sm-8">
                                <project-select project="vm.project" select-classes="form-control"
                                                required="true"></project-select>
                            </div>
                        </div>

                        <div class="form-group" show-errors>
                            <label for="expeditionCode" class="col-xs-3 control-label">Expedition Name</label>
                            <div class="row col-xs-8">
                                <div class="col-xs-8" ng-show="!vm.newExpedition">
                                    <select id="expeditionCode" name="expeditionCode"
                                            ng-model="vm.expeditionCode"
                                            ng-change="vm.setIsPublic(expedition)"
                                            ng-options="expedition.expeditionCode as expedition.expeditionTitle for expedition in vm.expeditions | orderBy: 'expeditionTitle' track by expedition.expeditionId"
                                            required
                                            class="form-control col-xs-6">
                                        <option value="">-- Select an Expedition --</option>
                                    </select>
                                </div>
                                <div class="col-xs-8" ng-show="vm.newExpedition">
                                    <input type="text" class="form-control" name="newExpeditionCode"
                                           ng-model="vm.expeditionCode"
                                           required ng-pattern=/^[a-zA-Z0-9_-]{4,50}$/ />
                                </div>
                                <label class="col-xs-3 checkbox-inline">
                                    <input type="checkbox" name="newExpedition"
                                           ng-model="vm.newExpedition"
                                           ng-click="vm.expeditionCode = null"
                                           value="true"/>
                                    New Expedition?
                                </label>
                                <div class="col-xs-12" ng-show="vm.newExpedition">
                                    <p class="help-block"
                                       ng-if="vm.uploadForm.newExpeditionCode.$error.pattern && vm.uploadForm.newExpeditionCode.$touched">
                                        <b>Expedition
                                            Name</b> must contain only numbers, letters, or underscores and be 4 to 50
                                        characters long</p>
                                    <p class="help-block col-xs-12" style="padding-left:0px;"
                                       ng-show="vm.uploadForm.newExpeditionCode.$error.exists">
                                        Expedition with that name already exists
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-xs-offset-2">
                                <div class="col-xs-8 checkbox">
                                    <label>
                                        <input type="checkbox" name="isPublic" ng-model="vm.isPublic"/>
                                        <span class="control-label">Public Expedition?</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <hr class="separator"/>

                        <div class="form-group">
                            <div class="col-xs-1 col-xs-offset-9">
                                <button type="submit" class="btn btn-primary pull-right">Upload</button>
                            </div>
                        </div>

                    </form>
                </uib-tab>

                <!-- Results Tab -->
                <uib-tab index="2" heading="Results" disable="!vm.displayResults">
                    <div class="col-xs-11 col-xs-offset-1"
                         ng-include="'app/components/validation/results/results.tpl.html'">
                    </div>
                </uib-tab>
            </uib-tabset>


            <div id='map' style="height:400px;width:600px;"></div>
        </div>
    </div>
</div>
